{"ast":null,"code":"import Eventful from './Eventful.js';\nimport env from './env.js';\nimport { isCanvasEl, transformCoordWithViewport } from './dom.js';\nvar MOUSE_EVENT_REG = /^(?:mouse|pointer|contextmenu|drag|drop)|click/;\nvar _calcOut = [];\nvar firefoxNotSupportOffsetXY = env.browser.firefox && +env.browser.version.split('.')[0] < 39;\nexport function clientToLocal(el, e, out, calculate) {\n  out = out || {};\n\n  if (calculate) {\n    calculateZrXY(el, e, out);\n  } else if (firefoxNotSupportOffsetXY && e.layerX != null && e.layerX !== e.offsetX) {\n    out.zrX = e.layerX;\n    out.zrY = e.layerY;\n  } else if (e.offsetX != null) {\n    out.zrX = e.offsetX;\n    out.zrY = e.offsetY;\n  } else {\n    calculateZrXY(el, e, out);\n  }\n\n  return out;\n}\n\nfunction calculateZrXY(el, e, out) {\n  if (env.domSupported && el.getBoundingClientRect) {\n    var ex = e.clientX;\n    var ey = e.clientY;\n\n    if (isCanvasEl(el)) {\n      var box = el.getBoundingClientRect();\n      out.zrX = ex - box.left;\n      out.zrY = ey - box.top;\n      return;\n    } else {\n      if (transformCoordWithViewport(_calcOut, el, ex, ey)) {\n        out.zrX = _calcOut[0];\n        out.zrY = _calcOut[1];\n        return;\n      }\n    }\n  }\n\n  out.zrX = out.zrY = 0;\n}\n\nexport function getNativeEvent(e) {\n  return e || window.event;\n}\nexport function normalizeEvent(el, e, calculate) {\n  e = getNativeEvent(e);\n\n  if (e.zrX != null) {\n    return e;\n  }\n\n  var eventType = e.type;\n  var isTouch = eventType && eventType.indexOf('touch') >= 0;\n\n  if (!isTouch) {\n    clientToLocal(el, e, e, calculate);\n    var wheelDelta = getWheelDeltaMayPolyfill(e);\n    e.zrDelta = wheelDelta ? wheelDelta / 120 : -(e.detail || 0) / 3;\n  } else {\n    var touch = eventType !== 'touchend' ? e.targetTouches[0] : e.changedTouches[0];\n    touch && clientToLocal(el, touch, e, calculate);\n  }\n\n  var button = e.button;\n\n  if (e.which == null && button !== undefined && MOUSE_EVENT_REG.test(e.type)) {\n    e.which = button & 1 ? 1 : button & 2 ? 3 : button & 4 ? 2 : 0;\n  }\n\n  return e;\n}\n\nfunction getWheelDeltaMayPolyfill(e) {\n  var rawWheelDelta = e.wheelDelta;\n\n  if (rawWheelDelta) {\n    return rawWheelDelta;\n  }\n\n  var deltaX = e.deltaX;\n  var deltaY = e.deltaY;\n\n  if (deltaX == null || deltaY == null) {\n    return rawWheelDelta;\n  }\n\n  var delta = deltaY !== 0 ? Math.abs(deltaY) : Math.abs(deltaX);\n  var sign = deltaY > 0 ? -1 : deltaY < 0 ? 1 : deltaX > 0 ? -1 : 1;\n  return 3 * delta * sign;\n}\n\nexport function addEventListener(el, name, handler, opt) {\n  el.addEventListener(name, handler, opt);\n}\nexport function removeEventListener(el, name, handler, opt) {\n  el.removeEventListener(name, handler, opt);\n}\nexport var stop = function (e) {\n  e.preventDefault();\n  e.stopPropagation();\n  e.cancelBubble = true;\n};\nexport function isMiddleOrRightButtonOnMouseUpDown(e) {\n  return e.which === 2 || e.which === 3;\n}\nexport { Eventful as Dispatcher };","map":null,"metadata":{},"sourceType":"module"}